# **Infrastructure as Code (IaC) - DevOps Interview Questions**

## Table of Contents

### **Beginner Level (1-20 Questions)**
#### **Terraform**
1. [What is Infrastructure as Code (IaC) and why is it important?](#1-what-is-infrastructure-as-code-iac-and-why-is-it-important)
2. [What is Terraform and how does it work?](#2-what-is-terraform-and-how-does-it-work)
3. [What is the difference between Terraform and Ansible?](#3-what-is-the-difference-between-terraform-and-ansible)
4. [What are Terraform Providers?](#4-what-are-terraform-providers)
5. [What is a Terraform State File?](#5-what-is-a-terraform-state-file)
6. [What is the purpose of `terraform init`?](#6-what-is-the-purpose-of-terraform-init)
7. [How does Terraform manage dependencies between resources?](#7-how-does-terraform-manage-dependencies-between-resources)
8. [What is the difference between Terraform `apply` and `plan`?](#8-what-is-the-difference-between-terraform-apply-and-plan)
9. [What is a Terraform Module?](#9-what-is-a-terraform-module)
10. [How do you destroy resources in Terraform?](#10-how-do-you-destroy-resources-in-terraform)
11. [What is the difference between for_each and for in Terraform?](#11-what-is-the-difference-between-for_each-and-for-in-terraform)
12. [What are modules in terraform and why should you use them?](#12-what-are-modules-in-terraform-and-why-should-you-use-them)
13. [What is the role of statefile in Terraform?](#13-what-is-the-role-of-statefile-in-terraform)
14. [Have you considered storing statefile in git instead of AWS S3 or Azure Blob?](#14-have-you-considered-storing-statefile-in-git-instead-of-aws-s3-or-azure-blob)
15. [Explain terraform statefile management.](#15-explain-terraform-statefile-management)
16. [Two devops engineers attempt to update statefile at once. what happens?](#16-two-devops-engineers-attempt-to-update-statefile-at-once-what-happens)
17. [we dont have a cloud account. where can we store the statefile?](#17-we-dont-have-a-cloud-account-where-can-we-store-the-statefile)
18. [Do you use terraform enterprise or community edition?](#18-do-you-use-terraform-enterprise-or-community-edition)
19. [Have you heard of opentofu? Do you think it is better than terraform?](#19-have-you-heard-of-opentofu-do-you-think-it-is-better-than-terraform)
20. [Write terraform code to create any resource on aws.](#20-write-terraform-code-to-create-any-resource-on-aws)
21. [What is the difference between resource and datasource in Terraform?](#21-what-is-the-difference-between-resource-and-datasource-in-terraform)

#### **Ansible**
11. [What is Ansible and how does it work?](#11-what-is-ansible-and-how-does-it-work)
12. [What are Ansible Playbooks?](#12-what-are-ansible-playbooks)
13. [What is an Ansible Inventory file?](#13-what-is-an-ansible-inventory-file)
14. [What is the difference between Ansible Roles and Playbooks?](#14-what-is-the-difference-between-ansible-roles-and-playbooks)
15. [How do you run an Ansible Playbook?](#15-how-do-you-run-an-ansible-playbook)
16. [What is an Ansible Galaxy?](#16-what-is-an-ansible-galaxy)
17. [How does Ansible handle idempotency?](#17-how-does-ansible-handle-idempotency)
18. [What is Ansible Vault?](#18-what-is-ansible-vault)

#### **CloudFormation**
19. [What is AWS CloudFormation?](#19-what-is-aws-cloudformation)
20. [How do you create a CloudFormation stack?](#20-how-do-you-create-a-cloudformation-stack)

### **Intermediate Level (21-40 Questions)**
#### **Terraform**
21. [What is the difference between Terraform `local` and `remote` state?](#21-what-is-the-difference-between-terraform-local-and-remote-state)
22. [How do you handle secrets in Terraform?](#22-how-do-you-handle-secrets-in-terraform)
23. [What is Terraform Locking, and why is it important?](#23-what-is-terraform-locking-and-why-is-it-important)
24. [What is Terraform Workspaces?](#24-what-is-terraform-workspaces)
25. [How do you create reusable Terraform modules?](#25-how-do-you-create-reusable-terraform-modules)
26. [What is Terraform Cloud and Terraform Enterprise?](#26-what-is-terraform-cloud-and-terraform-enterprise)
27. [How does Terraform handle drift detection?](#27-how-does-terraform-handle-drift-detection)
28. [How do you use `count` and `for_each` in Terraform?](#28-how-do-you-use-count-and-for_each-in-terraform)

#### **Ansible**
29. [How do you use Ansible variables?](#29-how-do-you-use-ansible-variables)
30. [What are Ansible Facts?](#30-what-are-ansible-facts)
31. [What is the purpose of Ansible Handlers?](#31-what-is-the-purpose-of-ansible-handlers)
32. [How does Ansible manage dependencies?](#32-how-does-ansible-manage-dependencies)
33. [What is the difference between `command` and `shell` modules in Ansible?](#33-what-is-the-difference-between-command-and-shell-modules-in-ansible)
34. [What is Ansible Dynamic Inventory?](#34-what-is-ansible-dynamic-inventory)

#### **CloudFormation**
35. [What are the main components of AWS CloudFormation?](#35-what-are-the-main-components-of-aws-cloudformation)
36. [How do you update a CloudFormation stack?](#36-how-do-you-update-a-cloudformation-stack)
37. [What is the difference between `DependsOn` and `CreationPolicy` in CloudFormation?](#37-what-is-the-difference-between-dependson-and-creationpolicy-in-cloudformation)
38. [How do you use Conditions in CloudFormation?](#38-how-do-you-use-conditions-in-cloudformation)
39. [What is AWS CloudFormation Drift Detection?](#39-what-is-aws-cloudformation-drift-detection)
40. [What are Intrinsic Functions in CloudFormation?](#40-what-are-intrinsic-functions-in-cloudformation)

### **Advanced Level (41-60 Questions)**
#### **Terraform**
41. [How do you implement CI/CD pipelines with Terraform?](#41-how-do-you-implement-cicd-pipelines-with-terraform)
42. [What are Terraform Data Sources?](#42-what-are-terraform-data-sources)
43. [How do you manage Terraform module versions?](#43-how-do-you-manage-terraform-module-versions)
44. [How does Terraform handle circular dependencies?](#44-how-does-terraform-handle-circular-dependencies)
45. [What are Terraform `locals` and `output` variables?](#45-what-are-terraform-locals-and-output-variables)
46. [What is a Terraform Sentinel Policy?](#46-what-is-a-terraform-sentinel-policy)
47. [How do you roll back changes in Terraform?](#47-how-do-you-roll-back-changes-in-terraform)
48. [What is Terraform Refresh?](#48-what-is-terraform-refresh)
49. [How do you enforce security best practices in Terraform?](#49-how-do-you-enforce-security-best-practices-in-terraform)
50. [How does Terraform manage multi-cloud environments?](#50-how-does-terraform-manage-multi-cloud-environments)

#### **Ansible**
51. [How do you test Ansible Playbooks before applying them?](#51-how-do-you-test-ansible-playbooks-before-applying-them)
52. [How do you handle error handling in Ansible?](#52-how-do-you-handle-error-handling-in-ansible)
53. [How do you implement Ansible Vault in CI/CD?](#53-how-do-you-implement-ansible-vault-in-cicd)
54. [How does Ansible integrate with Kubernetes?](#54-how-does-ansible-integrate-with-kubernetes)
55. [How do you ensure Ansible Playbooks are idempotent?](#55-how-do-you-ensure-ansible-playbooks-are-idempotent)

#### **CloudFormation**
56. [How do you modularize CloudFormation templates?](#56-how-do-you-modularize-cloudformation-templates)
57. [How do you manage parameter changes in CloudFormation?](#57-how-do-you-manage-parameter-changes-in-cloudformation)
58. [How do you handle stateful resources in CloudFormation?](#58-how-do-you-handle-stateful-resources-in-cloudformation)
59. [What is AWS CloudFormation Stack Policy?](#59-what-is-aws-cloudformation-stack-policy)
60. [How do you debug CloudFormation failures?](#60-how-do-you-debug-cloudformation-failures)

---

## **ðŸš€ Beginner-Level Infrastructure as Code (IaC) Questions (1-20)**

#### *(Terraform, Ansible, CloudFormation)*

### **Terraform Questions**  

### **1. What is Infrastructure as Code (IaC) and why is it important?**  

**Answer:**  
Infrastructure as Code (IaC) is a **method of managing and provisioning infrastructure** using code instead of manual processes. It allows:  
âœ… **Automation** of infrastructure deployment  
âœ… **Consistency** by reducing human errors  
âœ… **Scalability** through repeatable scripts  

---

### **2. What is Terraform and how does it work?**  

**Answer:**  
Terraform is an **open-source IaC tool** by HashiCorp that helps define and provision infrastructure using a declarative configuration language. It follows three steps:  

1. **Write**: Define infrastructure in `.tf` files  
2. **Plan**: Preview changes before applying  
3. **Apply**: Deploy and manage resources  

Example:

```hcl
provider "aws" {
  region = "us-east-1"
}

resource "aws_instance" "my_instance" {
  ami           = "ami-12345678"
  instance_type = "t2.micro"
}
```

---

### **3. What is the difference between Terraform and Ansible?**  

**Answer:**  

| Feature | Terraform | Ansible |
|---------|----------|---------|
| **Type** | Declarative | Imperative |
| **Purpose** | Infrastructure provisioning | Configuration management |
| **State Management** | Uses state file | Stateless |
| **Example Use** | Creating VMs, Networks | Installing software, configuring OS |

---

### **4. What are Terraform Providers?**  

**Answer:**  
Providers are **plugins** that allow Terraform to manage resources on different platforms (AWS, Azure, GCP, Kubernetes, etc.).  

Example:  

```hcl
provider "aws" {
  region = "us-west-2"
}
```

---

### **5. What is a Terraform State File?**  

**Answer:**  
Terraform maintains infrastructure details in a **state file (`terraform.tfstate`)**, which:  
âœ… Tracks existing resources  
âœ… Enables incremental changes  
âœ… Supports remote storage (e.g., S3, Azure Blob)  

To store state remotely:  

```hcl
backend "s3" {
  bucket = "my-terraform-state"
  key    = "terraform.tfstate"
  region = "us-east-1"
}
```

---

### **6. What is the purpose of `terraform init`?**  

**Answer:**  
It initializes the working directory by:  
âœ… Downloading providers  
âœ… Setting up backend storage  
âœ… Validating configuration  

Command:  

```sh
terraform init
```

---

### **7. How does Terraform manage dependencies between resources?**  

**Answer:**  
Terraform uses **implicit and explicit dependencies**:  

- **Implicit:** Recognized automatically  
- **Explicit:** Defined using `depends_on`  

Example:  

```hcl
resource "aws_instance" "web" {
  ami           = "ami-12345678"
  instance_type = "t2.micro"
}

resource "aws_ebs_volume" "data" {
  size          = 10
  availability_zone = "us-east-1a"
  depends_on    = [aws_instance.web]
}
```

---

### **8. What is the difference between Terraform `apply` and `plan`?**  

**Answer:**  

| Command | Purpose |
|---------|---------|
| `terraform plan` | Shows proposed changes before applying |
| `terraform apply` | Executes changes to create/update resources |

---

### **9. What is a Terraform Module?**  

**Answer:**  
A **module** is a reusable collection of Terraform configurations that helps **organize** code.  

Example of a module (`main.tf`):  

```hcl
module "network" {
  source = "./modules/vpc"
}
```

---

### **10. How do you destroy resources in Terraform?**  

**Answer:**  
Use:  

```sh
terraform destroy
```

This removes all resources defined in the configuration.

---

### **11. What is the difference between for_each and for in Terraform?**
**Answer:**
**for_each** is used to create multiple instances of a resource based on a map or set, while **for** is used for iterating over lists or maps to generate values.

### **12. What are modules in terraform and why should you use them?**
**Answer:**
Modules are **self-contained packages** of Terraform configurations that can be reused across different projects. They promote **code reusability**, **organization**, and **scalability**.

### **13. What is the role of statefile in Terraform?**
**Answer:**
The state file (`terraform.tfstate`) is a **snapshot of the current infrastructure** managed by Terraform. It tracks resource attributes and dependencies, enabling Terraform to manage updates and changes effectively.

### **14. Have you considered storing statefile in git instead of AWS S3 or Azure Blob?**
**Answer:**
Storing the state file in Git is **not recommended** due to security risks and potential conflicts. Instead, use remote backends like AWS S3 or Azure Blob for better security and collaboration.

### **15. Explain terraform statefile management.**
**Answer:**
Terraform state file management involves:
- **Initialization**: Setting up the state file with `terraform init`.
- **Locking**: Preventing concurrent modifications using remote backends.
- **Versioning**: Keeping track of changes to the state file.
- **Backup**: Regularly backing up the state file to prevent data loss. 

### **16. Two devops engineers attempt to update statefile at once. what happens?**
**Answer:**
If two engineers attempt to update the state file simultaneously, it can lead to a state file corruption or conflicts. Terraform uses **state locking** to prevent this by allowing only one operation at a time on the state file.

### **17. we dont have a cloud account. where can we store the statefile?**
**Answer:**
If you don't have a cloud account, you can store the state file locally on your machine or use a version control system like Git. However, for team collaboration, it's better to use a remote backend like a local file server or a shared network drive.

### **18. Do you use terraform enterprise or community edition?**
**Answer:**
Terraform Enterprise is used for larger teams and organizations that require advanced features like policy enforcement, role-based access control, and collaboration tools. The Community Edition is suitable for smaller teams or individual projects.

### **19. Have you heard of opentofu? Do you think it is better than terraform?**
**Answer:**
OpenTofu is an open-source alternative to Terraform, focusing on community-driven development. It may offer similar features, but whether it's better depends on specific use cases and community support. Terraform has a larger ecosystem and more mature tooling.

### **20. Write terraform code to create any resource on aws.**
**Answer:**
```hcl
provider "aws" {
  region = "us-east-1"
}
resource "aws_s3_bucket" "my_bucket" {
  bucket = "my-unique-bucket-name"
  acl    = "private"

  tags = {
    Name        = "MyBucket"
    Environment = "Dev"
  }
}
``` 

### **21. What is the difference between resource and datasource in Terraform?**
**Answer:**
A **resource** is a component that Terraform manages, such as an EC2 instance or S3 bucket. A **data source** is used to fetch information about existing resources that are not managed by Terraform, such as retrieving the latest AMI ID or VPC details.

---

### **Ansible Questions**  

### **11. What is Ansible and how does it work?**  

**Answer:**  
Ansible is an **open-source configuration management tool** that automates tasks like software installation, updates, and deployments. It works **agentless**, using SSH or WinRM.  

---

### **12. What are Ansible Playbooks?**  

**Answer:**  
A playbook is a **YAML-based automation script** that defines tasks to be executed.  

Example (`playbook.yml`):  

```yaml
- name: Install Nginx
  hosts: web
  tasks:
    - name: Install Nginx
      apt:
        name: nginx
        state: present
```

---

### **13. What is an Ansible Inventory file?**  

**Answer:**  
The inventory file **lists managed servers** and their details.  

Example (`inventory.ini`):  

```ini
[web]
server1 ansible_host=192.168.1.10
server2 ansible_host=192.168.1.11
```

---

### **14. What is the difference between Ansible Roles and Playbooks?**  

**Answer:**  

| Feature | Playbook | Role |
|---------|---------|------|
| **Scope** | Task-oriented | Component-oriented |
| **Organization** | Single YAML file | Structured directory |
| **Usage** | Small-scale automation | Large-scale projects |

---

### **15. How do you run an Ansible Playbook?**  

**Answer:**  
Command:  

```sh
ansible-playbook playbook.yml -i inventory.ini
```

---

### **16. What is an Ansible Galaxy?**  

**Answer:**  
Ansible Galaxy is a **repository for pre-built Ansible roles**.  

Example:  

```sh
ansible-galaxy install geerlingguy.nginx
```

---

### **17. How does Ansible handle idempotency?**  

**Answer:**  
Ansible ensures **repeated executions produce the same result** by only applying changes when needed.  

Example:  

```yaml
- name: Ensure Nginx is installed
  apt:
    name: nginx
    state: present
```
If Nginx is already installed, the task is skipped.

---

### **18. What is Ansible Vault?**  

**Answer:**  
Ansible Vault **encrypts sensitive data** like passwords.  

To create an encrypted file:  

```sh
ansible-vault encrypt secrets.yml
```

---

### **CloudFormation Questions**  

### **19. What is AWS CloudFormation?**  

**Answer:**  
AWS CloudFormation is an **IaC service** that provisions AWS infrastructure using YAML/JSON templates.  

Example:  

```yaml
Resources:
  MyBucket:
    Type: "AWS::S3::Bucket"
```

---

### **20. How do you create a CloudFormation stack?**  

**Answer:**  
Command:  

```sh
aws cloudformation create-stack --stack-name my-stack --template-body file://template.yml
```

---

## **ðŸš€ Intermediate-Level Infrastructure as Code (IaC) Questions (21-40)**  

#### *(Terraform, Ansible, CloudFormation)*  

---

### **Terraform Questions**  

### **21. What is the difference between Terraform `local` and `remote` state?**  

**Answer:**  
Terraform state can be stored **locally** (on disk) or **remotely** (in S3, Consul, etc.).  

| Storage | Pros | Cons |
|---------|------|------|
| **Local State** (`terraform.tfstate`) | Fast, simple | Not suitable for teams |
| **Remote State** (S3, etc.) | Shared, secure | Slightly slower |

Example remote state (S3 backend):  

```hcl
terraform {
  backend "s3" {
    bucket = "my-terraform-state"
    key    = "prod/terraform.tfstate"
    region = "us-east-1"
  }
}
```

---

### **22. How do you handle secrets in Terraform?**  

**Answer:**  
Avoid hardcoding secrets in `.tf` files:  
âœ… Use **environment variables**  
âœ… Use **Terraform Vault Provider**  
âœ… Store secrets in **AWS Secrets Manager**  

Example using environment variables:  

```sh
export TF_VAR_db_password="mypassword"
```

---

### **23. What is Terraform Locking, and why is it important?**  

**Answer:**  
Terraform uses **state locking** to prevent simultaneous updates by multiple users.  

- **Enabled automatically** for remote state backends (e.g., S3 + DynamoDB).  

Example (DynamoDB locking):  

```hcl
backend "s3" {
  bucket         = "my-terraform-bucket"
  dynamodb_table = "terraform-lock"
}
```

---

### **24. What is Terraform Workspaces?**  

**Answer:**  
Terraform **Workspaces** allow managing multiple environments within a single configuration.  

```sh
terraform workspace new dev
terraform workspace select dev
```

---

### **25. How do you create reusable Terraform modules?**  

**Answer:**  
Modules help organize and reuse code.  

Example (`modules/network/main.tf`):  

```hcl
variable "vpc_cidr" {}

resource "aws_vpc" "main" {
  cidr_block = var.vpc_cidr
}
```

Usage:  

```hcl
module "vpc" {
  source   = "./modules/network"
  vpc_cidr = "10.0.0.0/16"
}
```

---

### **26. What is Terraform Cloud and Terraform Enterprise?**  

**Answer:**  

| Feature | Terraform Cloud | Terraform Enterprise |
|---------|----------------|----------------------|
| **Type** | SaaS | Self-hosted |
| **Use Case** | Collaboration, remote state | Large enterprises |
| **Extras** | Remote execution, VCS integration | Advanced security & governance |

---

### **27. How does Terraform handle drift detection?**  

**Answer:**  
Terraform detects drift by running:  

```sh
terraform plan
```

Drift occurs when **actual infrastructure** changes outside Terraformâ€™s control.

---

### **28. How do you use `count` and `for_each` in Terraform?**  

**Answer:**  

- `count` is used for **simple lists**.  
- `for_each` is used for **maps or sets**.  

Example (`count`):  

```hcl
resource "aws_instance" "web" {
  count = 3
  ami   = "ami-12345678"
}
```

Example (`for_each`):  

```hcl
resource "aws_s3_bucket" "buckets" {
  for_each = toset(["dev", "prod"])
  bucket   = "my-app-${each.value}"
}
```

---

### **Ansible Questions**  

### **29. How do you use Ansible variables?**  

**Answer:**  
Variables can be defined in:  
âœ… Playbooks (`vars:`)  
âœ… Inventory (`host_vars`, `group_vars`)  
âœ… Command-line (`-e` flag)  

Example:  

```yaml
- hosts: web
  vars:
    app_port: 8080
  tasks:
    - debug: msg="App runs on port {{ app_port }}"
```

---

### **30. What are Ansible Facts?**  

**Answer:**  
Facts are **system information** collected automatically.  

Example:  

```sh
ansible all -m setup
```

---

### **31. What is the purpose of Ansible Handlers?**  

**Answer:**  
Handlers run **only when notified**.  

Example:  

```yaml
- name: Install Nginx
  apt:
    name: nginx
  notify: Restart Nginx

- name: Restart Nginx
  service:
    name: nginx
    state: restarted
  listen: Restart Nginx
```

---

### **32. How does Ansible manage dependencies?**  

**Answer:**  
Ansible Roles handle dependencies using `meta/main.yml`.  

Example:  

```yaml
dependencies:
  - role: common
```

---

### **33. What is the difference between `command` and `shell` modules in Ansible?**  

**Answer:**  

| Module | When to Use | Example |
|--------|------------|---------|
| `command` | Runs a command without shell features | `ansible all -m command -a "ls"` |
| `shell` | Runs commands with shell features (`|`,`&&`) | `ansible all -m shell -a "echo hello | tee file.txt"` |

---

### **34. What is Ansible Dynamic Inventory?**  

**Answer:**  
Dynamic Inventory **fetches live host lists** from AWS, Azure, GCP.  

Example for AWS:  

```sh
ansible-inventory --list -i aws_ec2.yml
```

---

## **CloudFormation Questions**

### **35. What are the main components of AWS CloudFormation?**  

**Answer:**  

| Component | Description |
|-----------|------------|
| **Templates** | Defines resources in YAML/JSON |
| **Stacks** | Collection of AWS resources |
| **StackSets** | Deploy stacks across multiple accounts |

---

### **36. How do you update a CloudFormation stack?**  

**Answer:**  
Use:  

```sh
aws cloudformation update-stack --stack-name my-stack --template-body file://template.yml
```

---

### **37. What is the difference between `DependsOn` and `CreationPolicy` in CloudFormation?**  

**Answer:**  

| Feature | Purpose |
|---------|---------|
| `DependsOn` | Ensures a resource is created before another |
| `CreationPolicy` | Waits for a signal before marking as successful |

Example (`DependsOn`):  

```yaml
Resources:
  WebServer:
    Type: AWS::EC2::Instance
    DependsOn: MyDB
```

---

### **38. How do you use Conditions in CloudFormation?**  

**Answer:**  
Conditions allow resources to be created based on parameters.  

Example:  

```yaml
Conditions:
  IsProd: !Equals [!Ref EnvType, "Prod"]
Resources:
  MyBucket:
    Type: AWS::S3::Bucket
    Condition: IsProd
```

---

### **39. What is AWS CloudFormation Drift Detection?**  

**Answer:**  
Detects **manual changes** to resources outside CloudFormation.  

Run drift check:  

```sh
aws cloudformation detect-stack-drift --stack-name my-stack
```

---

### **40. What are Intrinsic Functions in CloudFormation?**  

**Answer:**  
Intrinsic functions **dynamically reference values**.  

Example (`!Sub` for string interpolation):  

```yaml
Resources:
  MyBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub "${AWS::AccountId}-my-bucket"
```

---

## **ðŸš€ Advanced-Level Infrastructure as Code (IaC) Questions (41-60)**  

#### *(Terraform, Ansible, CloudFormation)*  

---

### **Terraform Questions**  

### **41. How do you implement CI/CD pipelines with Terraform?**  

**Answer:**  
Terraform can be integrated into CI/CD pipelines using **GitHub Actions, GitLab CI, or Jenkins**.  
âœ… **Linting & Validation:** `terraform fmt`, `terraform validate`  
âœ… **Planning:** `terraform plan -out=tfplan`  
âœ… **Apply Changes:** `terraform apply tfplan`  

Example GitHub Actions workflow:  

```yaml
jobs:
  terraform:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v1
      - name: Terraform Init
        run: terraform init
      - name: Terraform Plan
        run: terraform plan -out=tfplan
      - name: Terraform Apply
        run: terraform apply tfplan
```

---

### **42. What are Terraform Data Sources?**  

**Answer:**  
Data sources allow Terraform to **query external resources** without managing them.  

Example:  

```hcl
data "aws_vpc" "existing_vpc" {
  filter {
    name   = "tag:Name"
    values = ["my-vpc"]
  }
}
```

---

### **43. How do you manage Terraform module versions?**  

**Answer:**  
Use version constraints in `source`.  

Example (`versions.tf`):  

```hcl
module "vpc" {
  source  = "terraform-aws-modules/vpc/aws"
  version = "3.5.0"
}
```

---

### **44. How does Terraform handle circular dependencies?**  

**Answer:**  
Terraform detects and prevents **circular dependencies** by analyzing the **DAG (Directed Acyclic Graph)**.  
Solution:  
âœ… **Use `depends_on`** explicitly  
âœ… **Refactor resources**  

Example:  

```hcl
resource "aws_instance" "web" {
  depends_on = [aws_s3_bucket.logs]
}
```

---

### **45. What are Terraform `locals` and `output` variables?**  

**Answer:**  

- `locals`: Store **temporary values**  
- `output`: Expose values after deployment  

Example:  

```hcl
locals {
  env_name = "dev"
}

output "instance_ip" {
  value = aws_instance.web.public_ip
}
```

---

### **46. What is a Terraform Sentinel Policy?**  

**Answer:**  
Sentinel is a **policy-as-code framework** that enforces compliance.  

Example policy (`enforce_cost.sentinel`):  

```hcl
import "tfplan"

main = rule { tfplan.cost_estimate.total_monthly_cost < 500 }
```

---

### **47. How do you roll back changes in Terraform?**  

**Answer:**  

- **Option 1:** Use version control (`git revert`)  
- **Option 2:** Manually restore the previous state  
- **Option 3:** Import last known working state:  

  ```sh
  terraform apply "tfstate-previous.json"
  ```

---

### **48. What is Terraform Refresh?**  

**Answer:**  
`terraform refresh` updates the state file **without modifying resources**.  

```sh
terraform refresh
```

---

### **49. How do you enforce security best practices in Terraform?**  

**Answer:**  
âœ… Use **IAM least privilege** for Terraform executions  
âœ… Store **state files securely** (S3 + DynamoDB)  
âœ… Run **security scans** with tools like **tfsec**  

Example:  

```sh
tfsec .
```

---

### **50. How does Terraform manage multi-cloud environments?**  

**Answer:**  
By using **multiple providers** in a single configuration.  

Example (AWS + Azure):  

```hcl
provider "aws" {
  region = "us-east-1"
}

provider "azurerm" {
  features {}
}
```

---

### **Ansible Questions**  

### **51. How do you test Ansible Playbooks before applying them?**  

**Answer:**  
âœ… Use `ansible-lint` for syntax validation  
âœ… Use **Molecule** for testing  

Example:  

```sh
molecule test
```

---

### **52. How do you handle error handling in Ansible?**  

**Answer:**  
Use `ignore_errors: yes` or `rescue` blocks.  

Example:  

```yaml
tasks:
  - name: Try to restart service
    service:
      name: nginx
      state: restarted
    ignore_errors: yes
```

---

### **53. How do you implement Ansible Vault in CI/CD?**  

**Answer:**  
Use environment variables to decrypt secrets.  

Example:  

```sh
ANSIBLE_VAULT_PASSWORD="myvaultpassword" ansible-playbook deploy.yml
```

---

### **54. How does Ansible integrate with Kubernetes?**  

**Answer:**  
âœ… Use the **k8s module**  
âœ… Define Kubernetes manifests in YAML  

Example:  

```yaml
- name: Deploy to Kubernetes
  k8s:
    state: present
    definition: "{{ lookup('file', 'deployment.yml') }}"
```

---

### **55. How do you ensure Ansible Playbooks are idempotent?**  

**Answer:**  
âœ… Always use `state: present`  
âœ… Run playbooks multiple times to check consistency  

Example:  

```yaml
- name: Ensure Nginx is installed
  apt:
    name: nginx
    state: present
```

---

### **CloudFormation Questions**  

### **56. How do you modularize CloudFormation templates?**  

**Answer:**  
âœ… Use **Nested Stacks**  
âœ… Use `AWS::CloudFormation::Stack`  

Example:  

```yaml
Resources:
  MyNetworkStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: "https://s3.amazonaws.com/my-bucket/network.yml"
```

---

### **57. How do you manage parameter changes in CloudFormation?**  

**Answer:**  
Use the `--parameters` flag during updates.  

Example:  

```sh
aws cloudformation update-stack --stack-name my-stack \
  --parameters ParameterKey=InstanceType,ParameterValue=t2.large
```

---

### **58. How do you handle stateful resources in CloudFormation?**  

**Answer:**  
âœ… Use **Stack Policies** to prevent deletions  
âœ… Enable **RetainPolicy** for S3, RDS  

Example:  

```yaml
Resources:
  MyBucket:
    Type: AWS::S3::Bucket
    DeletionPolicy: Retain
```

---

### **59. What is AWS CloudFormation Stack Policy?**  

**Answer:**  
A Stack Policy **prevents accidental updates or deletions**.  

Example:  

```json
{
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "Update:Delete",
      "Principal": "*",
      "Resource": "*"
    }
  ]
}
```

---

### **60. How do you debug CloudFormation failures?**  

**Answer:**  
âœ… Check the **CloudFormation console**  
âœ… Use `aws cloudformation describe-stack-events`  
âœ… Enable **rollback debugging**  

Example:  

```sh
aws cloudformation describe-stack-events --stack-name my-stack
```

---